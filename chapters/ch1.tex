\chapter{绪论}
\section{研究背景与意义}
随着互联网的飞速发展，包括社交网络分析、生物信息学、网络安全，交通规划等，其催生了丰富多样的实时应用，而这些实时应用生成的海量且复杂的数据，精准地描绘了现实世界中对象和对象之间的关联关系。
这些信息将有助于人们获得重要的决策指导信息。
这些关系数据不仅有助于描述复杂系统的结构，还能为决策过程提供重要的指导信息。
%以金融领域为例，分析第三方支付平台中的账户对象及其交易行为，可有效挖掘潜在的欺诈模式；在网络安全领域，监控设备通信流量的数据有助于及时识别并预防恶意攻击。


在动态数据的分析中，连续子图匹配（Continuous Subgraph Matching，简称CSM）问题是一个重要的研究方向，主要用于在动态图数据中实时识别与给定模式相匹配的子图。
与传统的静态子图匹配问题不同，CSM 需要在数据不断变化的情况下，依然能够高效、准确地找到符合特定结构的子图。
这种动态变化的场景在许多现实世界应用中具有广泛的适用性。
在金融反欺诈中，我们希望及时发现隐藏在交易网络中的大型欺诈团伙；在网络安全领域，安全人员更关注攻击模式的演变，以便及时拦截恶意攻击。
这些应用都对动态图子图匹配的计算效率和准确性提出了更高要求，因此，如何在动态环境下高效执行 CSM，成为了一个亟待解决的挑战。

与此同时，随着数据规模的爆炸式增长，这一问题变得更加紧迫。特别是进入 5G 时代后，数据的体量、种类和变化速度远超以往。
例如，截至2024年11月13日，微信及WeChat的月活跃账户数已达到13.82亿，几乎覆盖了全国人口，并且仍在增长；
而在电商领域，2024 年“双十一”购物节的全网交易额突破 1.44 万亿元，再创新高。
这些现象表明，我们正处在一个数据规模前所未有庞大的时代，而如何高效处理这些数据，成为计算机科学领域的重要课题之一。

在如此庞大的图数据中，符合某个特定模式的匹配结果可能非常多，但在实际应用中，我们通常更关注最有价值的结果。
例如，在金融欺诈模式的挖掘中~\cite{csm-cycle-DBLP:journals/pvldb/QiuCQPZLZ18}，监管机构更关心那些涉及交易金额最高的欺诈团伙，而非所有可疑交易模式；
在网络安全领域，管理员更倾向于定位受攻击最严重恶意攻击子网~\cite{traffic-graph-matching-DBLP:journals/pvldb/SongGCW14}，而非每一个潜在的攻击行为。
因此，在动态图匹配时，除了考虑拓扑结构，还需要引入边权属性、设定密度限制，以筛选出更具分析价值的子图集合。
这不仅能提高匹配结果的相关性，也能帮助分析人员更快定位核心问题，从而提升整体效率。

然而，目前的研究大多集中在静态图中的Top-k密度约束子图匹配问题~\cite{density-define-DBLP:journals/vldb/AngelKSSST14,dsm-noweight-Bahmani-DBLP:journals/pvldb/BahmaniKV12}，这种方法构建大量的离线索引来提供权重的上界，然而其索引构建所需要的时间和空间受到了查询图中的标签大小以及数量的影响，其高昂的索引构建开销使得这些方法在动态图中不具有普遍适用性。
此外，现有动态图的工作只聚焦于所有子图匹配结果的返回，在结果数量过大的情况下，也只能随机限定返回数量的上限，缺乏对返回结果的其他条件约束~\cite{csm-sjtree-DBLP:conf/edbt/ChoudhuryHCAF15,csm-IncIsoMatch-DBLP:conf/sigmod/FanLLTWW11,dsm-noweight-Hu-DBLP:conf/cikm/HuWC17,csm-turboflux-DBLP:conf/sigmod/KimSHLHCSJ18,csm-graphflowpp-DBLP:journals/tods/MhedhbiKS21,csm-symbi-DBLP:journals/pvldb/MinPPGIH21,csm-rapidflow-DBLP:journals/pvldb/SunSHL22}。

因此，在动态图场景中，结合密度约束和拓扑结构的连续子图匹配具有重要的实际应用价值。
通过密度优先排序返回密度最高的前k个匹配子图，数据分析人员可以更快定位最具代表性和决策价值的匹配结果，从而为各类实际应用提供更有针对性的支持。
基于这一背景，本文将重点探讨如何在连续子图匹配过程中引入密度剪枝机制，以提高算法的计算效率和匹配准确性，从而更好地应对动态图环境下的子图匹配挑战。
\section{国内外研究现状}
连续子图匹配（Continuous Subgraph Matching,CSM）是图数据管理领域的一个重要的研究方向，主要关注如何在动态图中高效检测与查询模式匹配的子图。
而与本课题——密度约束下的TopK连续子图匹配相关的工作有三类:现有连续子图匹配问题，Top-k密集子图挖掘问题，以及静态Top-k子图匹配的搜索过程。
然而，现有的研究方法普遍存在某些局限性，无法完全满足动态图场景下高效匹配的需求。以下将分别讨论这三类研究的主要进展及其局限性。
\subsection{现有的连续子图匹配方案}
在现有的关于连续子图匹配（CSM）的工作\cite{csm-sjtree-DBLP:conf/edbt/ChoudhuryHCAF15,csm-IncIsoMatch-DBLP:conf/sigmod/FanLLTWW11,csm-graphflow-DBLP:conf/sigmod/KankanamgeSMCS17,csm-turboflux-DBLP:conf/sigmod/KimSHLHCSJ18,csm-graphflowpp-DBLP:journals/tods/MhedhbiKS21,csm-symbi-DBLP:journals/pvldb/MinPPGIH21,csm-rapidflow-DBLP:journals/pvldb/SunSHL22}中，根据是否依赖辅助数据结构和索引，相关方法可以分为两类。

（1） 不依赖任何辅助数据结构或索引的方法。

爱丁堡大学的樊文飞教授提出了InslsoMatch\cite{csm-IncIsoMatch-DBLP:conf/sigmod/FanLLTWW11}方法，该方法通过提取局部更新范围的子图，并在搜索过程中调用静态子图匹配算法。
然而，静态算法的查询延迟较高，因为其通常需要构建复杂的索引或遍历整个图，导致查询效率低下。
加拿大滑铁卢大学的Semih团队提出了GraphFlow\cite{csm-graphflow-DBLP:conf/sigmod/KankanamgeSMCS17},利用Worst-Case Optiomal Join来优化搜索的过程，显著减少了搜索空间。
该团队随后提出了GraphFlow+\cite{csm-graphflowpp-DBLP:journals/tods/MhedhbiKS21}，该方法通过缓存GraphFlow的部分联接结果以加速后续的搜索。
这些方法均不维护任何的中间结果，并保留了完整的子图匹配结果集。

（2） 基于辅助数据结构和索引的方法

除了直接依赖增量计算的匹配方法外，另一类研究则借助辅助数据结构（如生成树、有向无环图（DAG））来加速子图匹配，以降低计算开销并提高查询效率。
例如，韩国的Kyoungmin提出TurboFlux\cite{csm-turboflux-DBLP:conf/sigmod/KimSHLHCSJ18}，这是一种基于生成树索引的连续子图匹配方法。它在查询图的生成树基础上，在数据图中构建相应的辅助索引，从而提升匹配效率。
TurboFlux 的核心优势在于其增量更新能力，可以快速定位受影响的区域，避免对整个图重新计算，从而大幅降低计算成本，使其在动态图环境下具有良好的适应性。
此外，韩国科学技术院的 Wook-Shin Han 教授团队提出Symbi\cite{csm-symbi-DBLP:journals/pvldb/MinPPGIH21}，该方法将查询图转化为有向无环图，并利用 DAG 对非树边的剪枝能力，在搜索过程中实现显著加速。。
另一项值得关注的研究是RapidFlow\cite{csm-rapidflow-DBLP:journals/pvldb/SunSHL22}，其采用全局索引策略，根据查询图的拓扑结构构建全局索引，并在查询过程中利用该索引快速生成局部索引，极大地减少子图匹配的计算开销。
此外，复旦大学郑卫国教授团队提出了一种具有成本效益的索引方法——CaLiG\cite{csm-calig-DBLP:journals/pacmmod/YangZZY23}，其核心思想是通过构建高效索引结构来减少回溯搜索的空间。
CaLiG 通过构建高效的索引结构，能够在匹配过程中快速剪枝，从而更高效地完成匹配任务。该方法在处理具有复杂拓扑结构的查询图时表现出较好的性能。

在国内，其他研究团队也在连续子图匹配领域作出了重要的贡献。例如北京大学的高军教授团队、邹磊教授团队、北京航天航空大学的马帅教授团队等，都在该领域开展了深入研究，并提出了多种优化策略。
尽管上述研究在提升匹配效率方面取得了重要进展，但它们普遍存在一个共同的局限性：大多数方法仅聚焦于搜索过程的剪枝优化，而缺乏对最终匹配结果数量的有效控制。
因此，在实际应用中，当查询图结构较简单时，匹配结果可能会过于庞大，导致后续的排序和筛选成本大幅增加。在大规模数据场景下，这种方法的局限性尤为突出，其往往只能返回匹配的总数或随机选取部分结果，而难以直接获得最优的前 $k$ 个匹配子图。
\subsection{现有的Top-k密集子图挖掘问题}
在现有的Top-k密集子图挖掘（Top K Dense Subgraph Mining）研究中，密度的定义通常根据图中节点的度数或边权值进行区分~\cite{dsm-noweight-Bahmani-DBLP:journals/pvldb/BahmaniKV12,dsm-noweight-Balalau-DBLP:conf/wsdm/BalalauBCGS15,dsm-noweight-Bonchi-DBLP:journals/corr/abs-2007-01533,dsm-noweight-Dondi-DBLP:journals/corr/abs-2002-07695,dsm-noweight-Fang-DBLP:journals/pvldb/FangYCLL19,dsm-noweight-Gabert-DBLP:conf/wsdm/GabertPC21,dsm-noweight-Hu-DBLP:conf/cikm/HuWC17,dsm-noweight-Ma-DBLP:journals/pvldb/MaCLH22,dsm-noweight-Mathieu-DBLP:journals/corr/abs-2010-07794,dsm-noweight-McGregor-DBLP:journals/corr/McGregorTVV15,dsm-noweight-Rozenshtein-DBLP:journals/tkdd/RozenshteinTG17,dsm-noweight-Saha-DBLP:journals/corr/abs-2212-08820,dsm-noweight-Tsourakakis-DBLP:conf/kdd/TsourakakisBGGT13,dsm-noweight-Valari-DBLP:conf/ssdbm/ValariKP12,dsm-noweight-Zhao-DBLP:conf/icalip/ZhaoQYB14,dsm-weight-Angel-DBLP:journals/vldb/AngelKSSST14,dsm-weight-Ma-DBLP:conf/icde/MaHWLH17,dsm-weight-Muhammad-DBLP:conf/cikm/NasirGMG17},

论是在动态还是静态场景中，这些方法的核心问题都是如何定义和计算图的“密度”，并基于这一指标寻找最密集的子图。
具体而言，密集子图的挖掘问题大致可以分为两类：一类是基于节点度数定义的密度，另一类是基于边权值定义的密度。

\subsubsection{基于节点度数的密度定义}
大多数的密集子图发现问题中密度的定义都与节点的度数有关。例如Garbert等人\cite{dsm-noweight-Gabert-DBLP:conf/wsdm/GabertPC21}提出了全动态的核算法，该算法支持小团枚举和k-core维护，并将问题分解为维护特殊的超图以及k-core，该算法的改进同样适用于trusses（高密度子图）。
Bahmani等人\cite{dsm-noweight-Bahmani-DBLP:journals/pvldb/BahmaniKV12}提出了基于Mapreduce框架的图数据流中的Top-k最密集子图发现问题。在MapReduce模型\cite{csm-mapreduce-DBLP:journals/cacm/DeanG08}下，该方法能够高效地进行并行化处理，在处理大规模数据时有显著优势。
此外，Valari等人\cite{dsm-noweight-Valari-DBLP:conf/ssdbm/ValariKP12}针对动态大图中的Top-k密集子图问题，提出了精确和近似算法的研究，精确算法基于密度的上下限来减少了精确密度计算的次数，而近似算法通过在计算速度和结果准确性之间进行权衡来加速搜索。
这些方法在动态场景下表现尤为突出，能够实现在实时更新图数据时持续提供有效的Top-k密集子图，找到根据节点度数定义的密度最大的子图。

\subsubsection{基于边权重的密度定义}
另一类研究则关注于基于边权值的密度定义。
例如，Muhammad\cite{dsm-weight-Muhammad-DBLP:conf/cikm/NasirGMG17}等人研究了在滑动窗口模型下的Top-k最密子图算法，该算法返回的结果是边权值和较大的前k个子图，且子图之间不存在相交关系。
与传统的Top-k最密子图方法不同，该模型只更新影响图的有限区域，而不是对于整个图进行重新计算。
Albert等人\cite{dsm-weight-Angel-DBLP:journals/vldb/AngelKSSST14}研究了在边权值实时更新下维护密集子图的算法，在该方法中是根据给定的密度阈值划分密集子图，随着边权重的实时更新，子图的密度会随之变化，导致子图状态发生变化，该算法提出了关于单个边权重更新所引起的密度变化幅度的理论分析。

尽管这些方法在密度阈值下的Top-k密集子图挖掘中取得了显著进展，但它们往往未对子图的拓扑结构进行约束。
这意味着，尽管子图满足密度阈值，但在结构上可能表现出较大的异质性，从而使得这些方法在连续子图匹配（CSM-TopK）问题中的应用变得困难。
在CSM-TopK问题中，我们不仅需要关注子图的密度，还需要对子图的结构进行约束，以确保结果不仅在密度上满足要求，还在拓扑结构上具有一致性。
因此，现有基于节点度数或边权重定义密度的 Top-k 密集子图挖掘方法，通常无法直接适用于 CSM-TopK 问题，亟需在子图的结构约束方面进行深入研究。

综上所述，尽管现有的Top-k密集子图发现方法在密度计算和图数据处理方面取得了诸多进展，但它们的研究重点仍然集中在密度的定义与计算，对子图的结构特性考虑不足。
在需要精确结构匹配的应用场景（如 CSM-TopK）中，现有方法往往难以满足实际需求。
因此，未来的研究应探索密度与拓扑结构相结合的策略，以提出更加适用于特定应用场景的 Top-K 密集子图挖掘方法。
%无论密度的定义是否相同，其密集子图发现问题主要聚焦于发现符合密度阈值的最密子图，但对于子图的结构没有进行任何约束，因此最终得到的密集子图在结构上各不相同，很难将这些方法应用于CSM-Topk。
\subsection{静态Top k密度优先级机制的子图匹配}
Gupta\cite{static-topk-Gupta-DBLP:conf/icde/GuptaGYCH14}是首个提出将密度与拓扑结构相结合的研究，并将这一问题定义为在信息网络中发现前$k$个有趣子图的问题。
在其研究中，Gupta首次提出了一种基于密度的子图匹配方法，密度定义为子图中边权的总和。
为了加速寻找前$k$个最有趣的子图，他提出了通过构建两种索引来减少搜索空间的策略：图拓扑结构索引和最大元路径索引。
这种方法的核心思想是通过捕捉图中节点的拓扑关系以及节点与特定元路径之间的关系来提高匹配效率。
%在该方法中，Gupta\cite{static-topk-Gupta-DBLP:conf/icde/GuptaGYCH14}通过构建两种索引来减少子图匹配的搜索空间，从而加速前k个有趣子图的发现：图拓扑结构索引和最大元路径索引。

具体来说，图拓扑结构索引通过为数据图中的每个节点存储沿特定元路径的所有d跳邻居的数量（其中$d \in \{1,\dots,D\}$）来捕捉节点之间的拓扑关系。
这种方式可以有效地简化匹配过程，减少不必要的计算，从而加速匹配过程。
最大元路径索引则记录每个节点在d跳特定元路径下的权值和的最大值，其中元路径是由路径中的节点标签组合而成。假设B是节点的平均邻居数，元路径的最大跳数为D，则该索引的时间复杂度为$O(BD)$。
因此，索引构建的时间复杂度为$O(|V_G|BD)$，空间复杂度为$O(|V_G|TD)$，其中T是节点标签的数量。
这种方法的最大优势在于，它通过有效的索引构建，可以利用索引的最大密度进行剪枝，减少了搜索空间，提高了匹配效率。
%由于时间和空间复杂度都呈指数增长，这使得索引构建的成本极高。
然而，这种方法的主要局限性在于，随着$d$的增大，索引构建的代价会显著增加，导致其在动态场景下的应用变得困难。
尤其是在需要实时更新图数据的情况下，Gupta提出的索引结构在计算和存储上都存在指数级的增长，限制了其在动态图中的适用性。
特别是在动态图的更新过程中，随着节点和边的频繁变化，现有索引结构需要频繁更新，这会导致索引构建的计算成本和存储成本都迅速攀升，难以适应实际应用中对实时性和效率的要求。


在此基础上，Chen\cite{static-topk-Chen-DBLP:journals/ijprai/ChenLCTL18}等人对Gupta的工作进行了优化，提出了通过压缩数据图来减少枚举的范围，同时通过基于一阶邻居筛选候选节点以降低图拓扑索引的成本。
在这一方法中，Chen等人首先通过压缩数据图来减少子图匹配时的枚举范围，并进一步通过筛选一阶邻居节点，降低了图拓扑索引的计算开销。
特别是在搜索阶段，Chen\cite{static-topk-Chen-DBLP:journals/ijprai/ChenLCTL18}等人选择从候选节点数最少的节点作为起始顶点，进行双向深度优先搜索，从而提高了搜索效率。
这一策略通过减少不必要的匹配计算，进一步加速了子图匹配过程。
然而，尽管这一方法在一定程度上优化了Gupta提出的算法，但其适用性仍然受到一定限制。
特别是，该方法仅适用于特定结构的查询图——路径类型的图，对于其他更复杂的查询图类型，其效果并不理想。

此外，尽管Chen等人提出的优化方法在某些场景下取得了一定的效果，但压缩数据图的策略在动态图中的应用仍然存在问题。
在动态图中，由于数据图是实时变化，压缩数据图需要辅助数据结构来应对其变化，而此策略并没有给出在动态图中的具体应对方式。
更重要的是，Chen等人依然保留了Gupta的最大元路径索引结构，若查询图的结构复杂，其元路径的深度会增加，从而导致该方法在时间和空间复杂度上依然呈指数级增长，难以满足动态图环境下的高效性需求。

%此外，压缩数据图的策略并不适用于动态图场景，且仍然保留了Gupta提出的最大元路径索引结构，因此其时空复杂度仍然是指数级的。

综上所述，尽管Gupta提出的密度与拓扑结构融合的定义与我们的问题定义相似，但其后续的研究工作都是针对静态图。
由于这些方法具有指数级的时间与空间复杂度，并且高度依赖特定的索引结构，在动态图或复杂查询图结构下，索引的更新和存储都会面临巨大的挑战。
因此，尽管这些方法在静态图中取得了一定的成功，但它们在动态图场景下的应用存在较大的局限性，无法有效适应实时更新和动态变化的需求，因而不能直接用于本文的课题。
\section{研究内容与贡献}
现有的连续子图匹配（CSM）工作主要集中于返回所有子图匹配结果，但在结果集过大的情况下，往往只能随机返回数量上限的子图，且缺乏对结果优先级的排序和筛选机制。
与此相关的经典问题是 Top-k 密集子图挖掘问题，但该问题通常不涉及对子图结构的约束。
此外，现有的基于密度优先级排序的Top-k机制，虽然能通过大量离线索引构建来优化性能，但其索引构建的时空复杂度高，难以适应动态场景的需求。
因此，在动态场景下进行按密度优先级排序的子图匹配，具有重要的现实意义。

因此，本研究的核心目标是提出一种新的方法，以解决动态场景下融合密度和拓扑结构约束的Top-k连续子图匹配问题。
具体而言，我们通过动态图模型中引入的边权值来量化密度优先级排序，并在返回的匹配结果时，确保它们不仅满足与查询图的结构匹配，还能按照密度优先级排序进入前$k$个子图（$k$为指定的参数）。具体的研究内容包括以下两个方面：

（1）插入更新下结合密度的增量查询搜索剪枝

      在插入更新的情况下，需要额外考虑密度约束来优化搜索剪枝策略。由于引入了密度优先级机制和匹配结果数量的限制，搜索的目标范围更窄。
      若继续采用传统的CSM的搜索策略，其效率不高。
      因此，需要新的搜索策略，重点研究如何结合密度优先级顺序以及结果数限定来高效剪枝，从而提升查询性能。

（2）删除更新下的Top-k密度子图补充策略

   在删除更新发生时，维护的前k个结果可能会出现包含已删除边的子图，这些子图将因删除操作而失效，导致结果集的大小小于$k$。
   此时，需要从数据图中补充新的子图以维持结果集的完整性。
   然而，相比于插入更新，补充操作的挑战更大，因为插入仅影响增量部分，而补充则需要在全图范围内重新搜索合适的子图。
   因此，设计高效的补充策略是删除更新场景下的关键问题。
   综上所述，CSM-TopK问题的核心挑战在于设计一种基于密度的高效索引结构以进行剪枝，并针对删除操作设计有效的补充策略。基于上述研究内容，本研究的贡献包括：
\begin{itemize}[label={\textbullet}]
    \item \textbf{CSM-TopK问题。}本研究首次提出了CSM-TopK问题，将TopK密度约束纳入动态加权图上的连续子图匹配问题，并证明了该问题是NP难的。
    \item \textbf{轻量级索引结构(MWstar)。}本文提供了CSM-TopK 计算框架，并设计了两种轻量级索引结构，分别为全局MWstar和局部MWstar，用于加速CSM-TopK问题的计算。在边的动态插入/删除操作中，MWstar索引能够维持线性空间和常数的更新时间。
    \item \textbf{图压缩技术。}本研究采用了一种基于查询的图压缩技术，通过该技术过滤掉不可能成为匹配的候选点，从而显著缩小初始数据图的规模。在此压缩图上应用 MWstar索引，使得在时间和空间上的性能更为高效，最终形成了本文的优化方案。
    \item \textbf{广泛的实验。}本文在真实世界的数据集上进行了广泛的实验，证实了我们的解决方案在在性能上明显优于对比解决方案，至少提高了两个数量级。
  \end{itemize}
\section{论文组织架构}
全文共分为五章，具体组织结构如下：

第 1 章\ 绪论。主要介绍了密度约束下的TopK连续子图匹配(CSM-TopK)研究背景以及研究意义，CSM-TopK的国内外研究现状以及本文的研究内容。

第 2 章 \ 相关知识。介绍本文研究的相关的理论及技术，主要包括图的基本概念、子图匹配以及连续子图匹配的基本概念和应用，最后介绍本课题的概念。

第 3 章\ 基于TopK密度剪枝的连续子图匹配问题。
首先给出 CSM-TopK 问题的基本定义，然后介绍本文提出的 CSM-TopK 基础框架。
接着，阐述基于密度剪枝策略的基线方案，并提供相应的伪代码以说明其实现过程。

第 4 章\ 轻量级索引MWStar。在密度约束下的TopK连续子图匹配问题的基础框架下，本章首先介绍轻量级索引结构MWStar的设计，随后提出了两种索引策略：全局 MWStar 和局部 MWStar，并通过理论分析证明了局部 MWStar 在密度上限方面的优势。
此外，本章还提出了针对数据图的图压缩策略，详细阐述了该策略的过滤机制以及压缩后的压缩图结构。
最后介绍了如何将图压缩策略与轻量级索引 MWStar 相结合。

第 5 章\ 实验设计与结果分析
本章基于第三和第四章提出的基线方法以及优化剪枝策略，在五个真实数据集上进行了大量实验，旨在验证和比较本文提出方法与其他对比方案在时空效率上的表现。实验结果表明，本文所提出的算法在效率上显著优于现有的解决方案。

结论。总结本文研究得出的结论以及说明本文工作的不足之处，并介绍了未来可进一步开展的研究工作。
